
## Logging and Auditing

### Syslog vs. Journald

HP-UX uses the classic text-based syslog. SLES 16 uses **Systemd Journald**.

* **Structure:** Journald stores logs in a binary format (/var/log/journal). It automatically indexes metadata: PID, UID, Systemd Unit, Executable Path.  
* **Querying:**  
  * *HP-UX:* grep "error" /var/adm/syslog/syslog.log  
  * *SLES 16:* journalctl \-p err \-u apache2 \--since "1 hour ago"  
  * *Benefit:* The ability to filter by *Unit* (-u) is incredibly powerful, isolating logs for a specific service regardless of where it sent its output (stdout, stderr, or syslog facility).

### Auditing: audsys vs. Linux Auditd

HP-UX audsys creates binary logs in /var/adm/audit/ that must be converted. Linux auditd does similarly but with different tooling.  
**Task: Find all failed login attempts in the last 24 hours.**

* HP-UX:  
  The admin must process the binary btmps file or audit logs.  
  Bash  
  \# /usr/sbin/acct/fwtmp \-X \< /var/adm/btmps | grep "non-zero-exit"  
  \# Or parsing audisp output

* SLES 16:  
  The ausearch tool queries the audit daemon logs directly.  
  Bash  
  \# ausearch \-m USER\_LOGIN \-sv no \-ts recent

  Explanation: \-m USER\_LOGIN filters for login messages. \-sv no filters for Success Value \= No (failed). \-ts recent implies the last 10 minutes, or use \-ts today.  
  Alternatively, for basic wtmp/btmp analysis:  
  Bash  
  \# lastb \--since yesterday

  This command reads /var/log/btmp (binary file of bad logins) and formats it instantly.