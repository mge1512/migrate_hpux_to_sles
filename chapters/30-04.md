
## Kernel Patching: Zero Downtime with kGraft

On HP-UX, a kernel patch (PHKL\_xxxx) essentially always requires a reboot to relink the kernel and load new code. This necessitates scheduled maintenance windows.  
SLES 16 includes SUSE Live Patching (kGraft).

### Technical Explanation of kGraft

kGraft allows the administrator to apply critical security patches to the running kernel *without* restarting the system or even stopping applications.

* **Mechanism:** It relies on the ftrace infrastructure in the Linux kernel. A live patch is loaded as a kernel module (.ko). This module contains the replacement code for a vulnerable function. kGraft injects a redirection (trampoline) at the beginning of the old function, diverting execution to the new function.  
* **Consistency:** kGraft uses a "lazy migration" model. It tracks kernel threads. A thread is migrated to the new function world only when it exits kernel space. This ensures that no thread sees an inconsistent state (e.g., calling the old function but getting data from the new one). Once all threads have transitioned, the old function is retired.

### Admin Workflow

1. **Check Status:** kgr status (Shows "ready").  
2. **Install Patch:** zypper install kernel-livepatch-SLE15-SPx...  
3. Verify: The patch applies immediately. kgr status shows "in\_progress" then "ready". The uname \-r version does not change, but the code in memory is patched.  
   This capability fundamentally changes the patching cadence, allowing security teams to patch Shellshock/Spectre-class vulnerabilities mid-day without business interruption.38


